<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <style>
    #grid-holder table {
      border-collapse: collapse;
      border: 6px double #554c4c;
    }

    #grid-holder tr:nth-child(even) {
      background-color: #e5b9c1;
    }

    #grid-holder tr:nth-child(odd) {
      background-color: #c69584;
    }

    #grid-holder td {
      border: 1px solid black;
      padding: 4px;
    }

    .menu-lodash ul {
      display: none;
      margin: 0;
    }

    .menu-lodash .title {
      font-weight: bold;
      cursor: pointer;
    }

    .menu-lodash .title:before {
      content: '▶';
      padding-right: 6px;
      color: green;
    }

    .menu-lodash.open ul {
      display: block;
    }

    .menu-lodash.open .title:before {
      content: '▼';
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.3.0/lodash.js"></script>
</head>

<body>
  <div class="template-lodash">
    <div class="template-lodash1">
      <h3><a href="https://learn.javascript.ru/template-lodash#shablon-dlya-tablitsy-s-polzovatelyami">Шаблон для
          таблицы с пользователями</a></h3>
      <div>
        <div id="grid-holder"></div>

        <script type="text/template" id="grid-template">

        <table>
            <% usersTemplate.forEach(function(item){ %>
          <tr>
                <td><%-item.name%></td>
                <td><%-item.age%></td>
          </tr>
          <% }); %>
        </table>
      </script>
      </div>

    </div>
    <div class="template-lodash2">
      <h3><a href="https://learn.javascript.ru/template-lodash#sdelayte-menyu-ssylkami">Сделайте меню ссылками</a></h3>
      <div></div>
    </div>
    <div class="template-lodash3">
      <h3><a href=""></a></h3>
      <div>
        <script type="text/template" id="menu-template">
            <div class="menu-lodash">
              <span class="title"><%-title%></span>
            </div>
          </script>

        <script type="text/template" id="menu-list-template">
            <ul>
                <%for (let key in items){ %>
                  <%item = items[key]%>
                  <li>
                    <a href="#<%-key%>" onclick='alert("<%-key%>")'><%-item%></a>
                  </li>
                  <% }; %>
            </ul>
          </script>
      </div>
    </div>
  </div>
</body>
<script>
  let usersTemplate = [{
    name: "Вася",
    age: 10
  }, {
    name: "Петя",
    age: 15
  }, {
    name: "Женя",
    age: 20
  }, {
    name: "Маша",
    age: 25
  }, {
    name: "Даша",
    age: 30
  },];
  let tmplTable = _.template(document.getElementById('grid-template').innerHTML);

  let createTable = tmplTable(usersTemplate);

  document.getElementById('grid-holder').innerHTML = createTable;
  // 3

  function MenuTmpl(options) {
    var elem;

    function getElem() {
      if (!elem) render();
      return elem;
    }

    function render() {
      var html = options.template({
        title: options.title
      });

      elem = document.createElement('div');
      elem.innerHTML = html;
      elem = elem.firstElementChild;

      elem.onmousedown = function () {
        return false;
      }

      elem.onclick = function (event) {
        if (event.target.closest('.title')) {
          toggle();
        }
      }
    }

    function renderItems() {
      if (elem.querySelector('ul')) return;

      var listHtml = options.listTemplate({
        items: options.items
      });
      elem.insertAdjacentHTML("beforeEnd", listHtml);
    }

    function open() {
      renderItems();
      elem.classList.add('open');
    };

    function close() {
      elem.classList.remove('open');
    };

    function toggle() {
      if (elem.classList.contains('open')) close();
      else open();
    };

    this.getElem = getElem;
    this.toggle = toggle;
    this.close = close;
    this.open = open;
  }
  let menuTmpl = new MenuTmpl({
    title: "Сладости",
    template: _.template(document.getElementById('menu-template').innerHTML.trim()),
    listTemplate: _.template(document.getElementById('menu-list-template').innerHTML.trim()),
    items: {
    "donut": "Пончик",
    "cake": "Пирожное",
    "chocolate": "Шоколадка"
  }
  });
  let items = {
    "donut": "Пончик",
    "cake": "Пирожное",
    "chocolate": "Шоколадка"
  }
  for (const key in items) {
    if (items.hasOwnProperty(key)) {
      const element = items[key];
      console.log(key,element);
    }
  }
  document.body.appendChild(menuTmpl.getElem());
</script>

</html>